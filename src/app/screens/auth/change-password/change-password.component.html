<div class="login-page">
    <div class="login-container">

        <!-- Left Preview Section -->
        <div class="preview-section">
            <div class="caption">
                <h3>Secure your workspace.</h3>
                <p>Keep your account protected with a strong password.</p>
            </div>

            <div class="vector-group">
                <div class="vector-illustration first">
                    <img src="assets/images/login.svg" alt="Vector 1" />
                </div>
                <div class="vector-illustration second">
                    <img src="assets/images/login-2.svg" alt="Vector 2" />
                </div>
            </div>

            <div class="ticket-actions-grid">
                <div class="action-card"><i class="bi bi-clipboard-data"></i><span>Progress Tracker</span></div>
                <div class="action-card"><i class="bi bi-person-lines-fill"></i><span>User Management</span></div>
                <div class="action-card"><i class="bi bi-bar-chart-line-fill"></i><span>Analytics</span></div>
                <div class="action-card"><i class="bi bi-ticket-detailed-fill"></i><span>Tickets Progress</span></div>
            </div>

            <div class="floating-icons">
                <i class="bi bi-person-fill icon" style="top: 10%; left: 15%;"></i>
                <i class="bi bi-clipboard-data icon" style="top: 30%; left: 70%;"></i>
                <i class="bi bi-person-lines-fill icon" style="top: 50%; left: 40%;"></i>
                <i class="bi bi-bar-chart-line-fill icon" style="top: 75%; left: 20%;"></i>
                <i class="bi bi-ticket-detailed-fill icon" style="top: 85%; left: 80%;"></i>
            </div>

            <div class="floating-particles">
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
            </div>

            <div class="cosmic-elements">
                <div class="cosmic-ring ring-1"></div>
                <div class="cosmic-ring ring-2"></div>
                <div class="cosmic-ring ring-3"></div>
            </div>
        </div>

        <!-- Right Form Section -->
        <div class="form-section">
            <div class="login-card">
                <div class="logo-wrapper">
                    <img src="assets/images/diplogo.png" alt="Company Logo" />
                </div>
                <h2 class="login-title">Change Password</h2>
                <p class="login-subtitle">Update your password to keep your account secure</p>

                <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()" class="login-form">
                    <label>Email Address</label>
                    <div class="input-group">
                        <i class="bi bi-envelope"></i>
                        <input type="email" formControlName="emailId" readonly style="background-color: #ececec" />
                    </div>
                    <small *ngIf="isFieldRequired('emailId')" class="error">Email is required.</small>
                    <small
                        *ngIf="(changePasswordForm.controls['emailId'].hasError('email') || changePasswordForm.controls['emailId'].hasError('pattern')) && changePasswordForm.controls['emailId'].touched"
                        class="error">Enter a valid email address.</small>

                    <label>Current Password</label>
                    <div class="input-group">
                        <i class="bi bi-lock"></i>
                        <input [type]="showOldPassword ? 'text' : 'password'" formControlName="oldPassword"
                            placeholder="Enter current password" />
                        <img src="assets/images/icons/viewPassword.svg" alt="Toggle Password" class="password-toggle"
                            (click)="showOldPassword = !showOldPassword" />
                    </div>
                    <small *ngIf="isFieldRequired('oldPassword')" class="error">Current password is required.</small>

                    <label>New Password</label>
                    <div class="input-group">
                        <i class="bi bi-lock"></i>
                        <input [type]="showNewPassword ? 'text' : 'password'" formControlName="newPassword"
                            placeholder="Enter new password" />
                        <img src="assets/images/icons/viewPassword.svg" alt="Toggle Password" class="password-toggle"
                            (click)="showNewPassword = !showNewPassword" />
                    </div>
                    <small *ngIf="isFieldRequired('newPassword')" class="error">New password is required.</small>
                    <small
                        *ngIf="changePasswordForm.controls['newPassword'].hasError('minLength') && changePasswordForm.controls['newPassword'].touched"
                        class="error">Password must be at least 6 characters.</small>
                    <small
                        *ngIf="changePasswordForm.controls['newPassword'].hasError('invalidCombination') && (changePasswordForm.controls['newPassword'].touched || changePasswordForm.controls['newPassword'].dirty)"
                        class="error">Password should include a special character, uppercase letter, and number.</small>

                    <button type="submit" class="submit-btn" [disabled]="!changePasswordForm.valid">Update
                        Password</button>
                    <p class="redirect">Return to login? <a routerLink="/auth/login">Back to Login</a></p>
                </form>
            </div>
        </div>
    </div>

    <div class="spinner" *ngIf="loadSpinner">Loading...</div>
</div>