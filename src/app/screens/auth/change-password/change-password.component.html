<div class="change-password-page">
    <!-- Left Section with Heading and Lottie -->
    <div class="left-panel">
        <div class="branding">
            <h1>Secure Your Account</h1>
            <p>Update your password to keep your Tick Wiz account protected and secure</p>
            <iframe src="https://lottie.host/embed/9c4d2ff3-cb8b-4cd6-ba45-ce5bf593a8da/JTPBONAPNy.lottie"
                frameborder="0" class="lottie-frame"></iframe>
        </div>
    </div>

    <!-- Right Section with Change Password Form -->
    <div class="change-password-container">
        <div class="form-section">
            <div class="change-password-card">
                <div class="logo-wrapper">
                    <img src="assets/images/diplogo.png" alt="Company Logo" />
                </div>
                <h2 class="change-password-title">Change Password</h2>
                <p class="change-password-subtitle">Update your password to keep your account secure</p>

                <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()" class="change-password-form">
                    <label>Email Address</label>
                    <div class="input-group">
                        <i class="bi bi-envelope"></i>
                        <input type="email" formControlName="emailId" readonly style="background-color: #ececec" />
                    </div>
                    <small *ngIf="isFieldRequired('emailId')" class="error">Email is required.</small>
                    <small
                        *ngIf="(changePasswordForm.controls['emailId'].hasError('email') || changePasswordForm.controls['emailId'].hasError('pattern')) && changePasswordForm.controls['emailId'].touched"
                        class="error">Enter a valid email address.</small>

                    <label>Current Password</label>
                    <div class="input-group">
                        <i class="bi bi-lock"></i>
                        <input [type]="showOldPassword ? 'text' : 'password'" formControlName="oldPassword"
                            placeholder="Enter current password" />
                        <i class="bi" [ngClass]="showOldPassword ? 'bi-eye-slash' : 'bi-eye'"
                            (click)="showOldPassword = !showOldPassword"></i>
                    </div>
                    <small *ngIf="isFieldRequired('oldPassword')" class="error">Current password is required.</small>

                    <label>New Password</label>
                    <div class="input-group">
                        <i class="bi bi-lock"></i>
                        <input [type]="showNewPassword ? 'text' : 'password'" formControlName="newPassword"
                            placeholder="Enter new password" />
                        <i class="bi" [ngClass]="showNewPassword ? 'bi-eye-slash' : 'bi-eye'"
                            (click)="showNewPassword = !showNewPassword"></i>
                    </div>
                    <small *ngIf="isFieldRequired('newPassword')" class="error">New password is required.</small>
                    <small
                        *ngIf="changePasswordForm.controls['newPassword'].hasError('minLength') && changePasswordForm.controls['newPassword'].touched"
                        class="error">Password must be at least 6 characters.</small>
                    <small
                        *ngIf="changePasswordForm.controls['newPassword'].hasError('invalidCombination') && (changePasswordForm.controls['newPassword'].touched || changePasswordForm.controls['newPassword'].dirty)"
                        class="error">Password should include a special character, uppercase letter, and number.</small>

                    <button type="submit" class="submit-btn" [disabled]="!changePasswordForm.valid">Change
                        Password</button>
                    <p class="redirect">Return to login? <a routerLink="/auth/login">Back to Login</a></p>
                </form>
            </div>
        </div>
    </div>

    <div class="spinner" *ngIf="loadSpinner">Loading...</div>
</div>